---
- name: Check installed
  shell: |
    dnf list --installed | grep keybase
  register: keybase_installed
  changed_when: false
  ignore_errors: true
  args:
    warn: off
  when:
    - ansible_distribution == "Fedora"

- name: Check installed
  shell: |
    apt list --installed | grep keybase
  register: keybase_installed
  changed_when: false
  ignore_errors: true
  args:
    warn: off
  when:
    - ansible_distribution == "Ubuntu"

- name: Install keybase
  dnf:
    name: "https://prerelease.keybase.io/keybase_amd64.rpm"
    state: present
    disable_gpg_check: true
  when:
    - keybase_installed.rc != 0
    - ansible_distribution == "Fedora"

- name: Install keybase
  apt:
    deb: "https://prerelease.keybase.io/keybase_amd64.deb"
    state: present
  when:
    - keybase_installed.rc != 0
    - ansible_distribution == "Ubuntu"

- name: Run keybase
  shell: run_keybase
  args:
    creates: /keybase

# curl --remote-name https://prerelease.keybase.io/keybase_amd64.deb
# sudo apt install ./keybase_amd64.deb

# yum install https://prerelease.keybase.io/keybase_amd64.rpm
# run_keybase
