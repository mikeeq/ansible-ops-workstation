---
- name: Directory for packer
  file:
    path: /tmp/packer
    state: directory

# https://releases.hashicorp.com/packer/1.8.6/packer_1.8.6_linux_{{ package_name }}.zip

- name: Download packer
  get_url:
    url: "https://releases.hashicorp.com/packer/{{ packer_version }}/{{ package_name }}"
    dest: /tmp/packer/packer.zip

- name: Unarchive a file that is already on the remote machine
  unarchive:
    src: /tmp/packer/packer.zip
    dest: /tmp/packer
    remote_src: yes

- name: Copy packer
  copy:
    src: "/tmp/packer/packer"
    dest: "/usr/local/bin/packer"
    remote_src: true
    mode: 0755
    owner: root
    group: root
