---
# https://docs.ansible.com/ansible/latest/collections/community/crypto/acme_certificate_module.html

- import_tasks: account_key.yml

- name: "Create dir for certs - {{ certs_path }}"
  file:
    path: "{{ certs_path }}"
    state: directory

- name: Generate cert
  include_tasks: cert.yml
  loop: "{{ certs }}"
  loop_control:
    loop_var: cert
  vars:
    dns_task_path: dns-coredns.yml
    domain_name: "{{ cert.domain_name }}"
